<!DOCTYPE html><html lang=pt class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Pedro Toledo Piza Civita"><link href=https://pedrocivita.github.io/exercises/3/ rel=canonical><link href=../2/ rel=prev><link href=../4/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.22"><title>3. MLP - Artificial Neural Networks and Deep Learning - pedrotpc</title><link rel=stylesheet href=../../assets/stylesheets/main.84d31ad4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M64%20480c-35.3%200-64-28.7-64-64V96c0-35.3%2028.7-64%2064-64h320c35.3%200%2064%2028.7%2064%2064v213.5c0%2017-6.7%2033.3-18.7%2045.3L322.7%20461.3c-12%2012-28.3%2018.7-45.3%2018.7zm325.5-176H296c-13.3%200-24%2010.7-24%2024v93.5z%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M384%20512H96c-53%200-96-43-96-96V96C0%2043%2043%200%2096%200h304c26.5%200%2048%2021.5%2048%2048v288c0%2020.9-13.4%2038.7-32%2045.3V448c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032zM96%20384c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h256v-64zm32-232c0%2013.3%2010.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24H152c-13.3%200-24%2010.7-24%2024m24%2072c-13.3%200-24%2010.7-24%2024s10.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24z%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m-32-352a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200m-8%2064h48c13.3%200%2024%2010.7%2024%2024v88h8c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-80c-13.3%200-24-10.7-24-24s10.7-24%2024-24h24v-64h-24c-13.3%200-24-10.7-24-24s10.7-24%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M461.2%2018.9C472.7%2024%20480%2035.4%20480%2048v416c0%2012.6-7.3%2024-18.8%2029.1s-24.8%203.2-34.3-5.1l-46.6-40.7c-43.6-38.1-98.7-60.3-156.4-63V480c0%2017.7-14.3%2032-32%2032h-32c-17.7%200-32-14.3-32-32v-96C57.3%20384%200%20326.7%200%20256s57.3-128%20128-128h84.5c61.8-.2%20121.4-22.7%20167.9-63.3L427%2024c9.4-8.3%2022.9-10.2%2034.3-5.1zM224%20320v.2c70.3%202.7%20137.8%2028.5%20192%2073.4V118.3c-54.2%2044.9-121.7%2070.7-192%2073.4z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M434.8%2070.1c14.3%2010.4%2017.5%2030.4%207.1%2044.7l-256%20352c-5.5%207.6-14%2012.3-23.4%2013.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200l101.5%20101.5%20234-321.7c10.4-14.3%2030.4-17.5%2044.7-7.1z%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m0-336c-17.7%200-32%2014.3-32%2032%200%2013.3-10.7%2024-24%2024s-24-10.7-24-24c0-44.2%2035.8-80%2080-80s80%2035.8%2080%2080c0%2047.2-36%2067.2-56%2074.5v3.8c0%2013.3-10.7%2024-24%2024s-24-10.7-24-24v-8.1c0-20.5%2014.8-35.2%2030.1-40.2%206.4-2.1%2013.2-5.5%2018.2-10.3%204.3-4.2%207.7-10%207.7-19.6%200-17.7-14.3-32-32-32zm-32%20192a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%200c14.7%200%2028.2%208.1%2035.2%2021l216%20400c6.7%2012.4%206.4%2027.4-.8%2039.5S486.1%20480%20472%20480H40c-14.1%200-27.2-7.4-34.4-19.5s-7.5-27.1-.8-39.5l216-400c7-12.9%2020.5-21%2035.2-21m0%20352a32%2032%200%201%200%200%2064%2032%2032%200%201%200%200-64m0-192c-18.2%200-32.7%2015.5-31.4%2033.7l7.4%20104c.9%2012.5%2011.4%2022.3%2023.9%2022.3%2012.6%200%2023-9.7%2023.9-22.3l7.4-104c1.3-18.2-13.1-33.7-31.4-33.7z%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20576%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M480-16c6.9%200%2013%204.4%2015.2%2010.9l13.5%2040.4%2040.4%2013.5C555.6%2051%20560%2057.1%20560%2064s-4.4%2013-10.9%2015.2l-40.4%2013.5-13.5%2040.4c-2.2%206.5-8.3%2010.9-15.2%2010.9s-13-4.4-15.2-10.9l-13.5-40.4-40.4-13.5C404.4%2077%20400%2070.9%20400%2064s4.4-13%2010.9-15.2l40.4-13.5%2013.5-40.4C467-11.6%20473.1-16%20480-16M321.4%2097.4c12.5-12.5%2032.8-12.5%2045.3%200l80%2080c12.5%2012.5%2012.5%2032.8%200%2045.3l-10.9%2010.9c7.9%2022%2012.2%2045.7%2012.2%2070.5%200%20114.9-93.1%20208-208%20208S32%20418.9%2032%20304%20125.1%2096%20240%2096c24.7%200%2048.5%204.3%2070.5%2012.3zM144%20304c0-53%2043-96%2096-96%2013.3%200%2024-10.7%2024-24s-10.7-24-24-24c-79.5%200-144%2064.5-144%20144%200%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M416%20427.4c58.5-44%2096-111.6%2096-187.4C512%20107.5%20397.4%200%20256%200S0%20107.5%200%20240c0%2075.8%2037.5%20143.4%2096%20187.4V464c0%2026.5%2021.5%2048%2048%2048h32v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h64v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h32c26.5%200%2048-21.5%2048-48zM96%20256a64%2064%200%201%201%20128%200%2064%2064%200%201%201-128%200m256-64a64%2064%200%201%201%200%20128%2064%2064%200%201%201%200-128%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M352%200c0-17.7-14.3-32-32-32s-32%2014.3-32%2032v64h-96c-53%200-96%2043-96%2096v224c0%2053%2043%2096%2096%2096h256c53%200%2096-43%2096-96V160c0-53-43-96-96-96h-96zM160%20368c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24M224%20176a48%2048%200%201%201%200%2096%2048%2048%200%201%201%200-96m144%2048a48%2048%200%201%201%2096%200%2048%2048%200%201%201-96%200m-304%200c0-17.7-14.3-32-32-32S0%20206.3%200%20224v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32zm544-32c-17.7%200-32%2014.3-32%2032v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32v-96c0-17.7-14.3-32-32-32%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M288%200H128c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032v151.5L7.5%20426.3C2.6%20435%200%20444.7%200%20454.7%200%20486.4%2025.6%20512%2057.3%20512h333.4c31.6%200%2057.3-25.6%2057.3-57.3%200-10-2.6-19.8-7.5-28.4L320%20215.5V64c17.7%200%2032-14.3%2032-32S337.7%200%20320%200zm-96%20215.5V64h64v151.5c0%2011.1%202.9%2022.1%208.4%2031.8L306%20320H142l41.6-72.7c5.5-9.7%208.4-20.6%208.4-31.8%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M0%20216C0%20149.7%2053.7%2096%20120%2096h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064H64c-35.3%200-64-28.7-64-64zm256%200c0-66.3%2053.7-120%20120-120h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064h-64c-35.3%200-64-28.7-64-64z%22/%3E%3C/svg%3E');}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_markdown_exec_pyodide.css><link rel=stylesheet href=../../assets/_markdown_exec_ansi.css><link rel=stylesheet href=../../css/extra.css><link rel=stylesheet href=../../assets/stylesheets/badge.css><link rel=stylesheet href=../../termynal.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><script src=../../assets/javascripts/glightbox.min.js></script><style id=glightbox-style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#exercicio-de-mlp-pedrotpc class=md-skip> Ir para o conteúdo </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Cabeçalho> <a href=../.. title="Artificial Neural Networks and Deep Learning - pedrotpc" class="md-header__button md-logo" aria-label="Artificial Neural Networks and Deep Learning - pedrotpc" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Artificial Neural Networks and Deep Learning - pedrotpc </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 3. MLP </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_3 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_3> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Buscar placeholder=Buscar autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class=md-search__options aria-label=Pesquisar> <button type=reset class="md-search__icon md-icon" title=Limpar aria-label=Limpar tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Inicializando a pesquisa </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/pedrocivita/pedrocivita.github.io title="Ir ao repositório" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> pedrocivita.github.io </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navegação data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Artificial Neural Networks and Deep Learning - pedrotpc" class="md-nav__button md-logo" aria-label="Artificial Neural Networks and Deep Learning - pedrotpc" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> Artificial Neural Networks and Deep Learning - pedrotpc </label> <div class=md-nav__source> <a href=https://github.com/pedrocivita/pedrocivita.github.io title="Ir ao repositório" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> pedrocivita.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Exercises </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Exercises </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../1/ class=md-nav__link> <span class=md-ellipsis> 1. Data </span> </a> </li> <li class=md-nav__item> <a href=../2/ class=md-nav__link> <span class=md-ellipsis> 2. Perceptron </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 3. MLP </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 3. MLP </span> </a> <nav class="md-nav md-nav--secondary" aria-label=Índice> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Índice </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#exercicio-1-calculo-manual-de-uma-mlp class=md-nav__link> <span class=md-ellipsis> Exercício 1: Cálculo manual de uma MLP </span> </a> <nav class=md-nav aria-label="Exercício 1: Cálculo manual de uma MLP"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#passo-1-passagem-direta class=md-nav__link> <span class=md-ellipsis> Passo 1 – Passagem direta </span> </a> <nav class=md-nav aria-label="Passo 1 – Passagem direta"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pre-ativacoes-da-camada-oculta class=md-nav__link> <span class=md-ellipsis> Pré ativações da camada oculta: </span> </a> </li> <li class=md-nav__item> <a href=#ativacoes-da-camada-oculta-usa-a-tangente-hiperbolica-tanhz-para-cada-elemento class=md-nav__link> <span class=md-ellipsis> Ativações da camada oculta: usa a tangente hiperbólica \(\tanh(z)\). Para cada elemento: </span> </a> </li> <li class=md-nav__item> <a href=#pre-ativacao-da-saida class=md-nav__link> <span class=md-ellipsis> Pré ativação da saída: </span> </a> </li> <li class=md-nav__item> <a href=#saida-final-haty-tanhz2-como-z2-approx-03852-entao class=md-nav__link> <span class=md-ellipsis> Saída final: \(\hat{y} = \tanh(z^{(2)})\). Como \(z^{(2)} \approx 0{,}3852\), então </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#passo-2-calculo-da-perda class=md-nav__link> <span class=md-ellipsis> Passo 2 – Cálculo da perda </span> </a> </li> <li class=md-nav__item> <a href=#passo-3-retropropagacao class=md-nav__link> <span class=md-ellipsis> Passo 3 – Retropropagação </span> </a> <nav class=md-nav aria-label="Passo 3 – Retropropagação"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gradiente-no-neuronio-de-saida class=md-nav__link> <span class=md-ellipsis> Gradiente no neurônio de saída: </span> </a> </li> <li class=md-nav__item> <a href=#propagacao-para-a-camada-oculta class=md-nav__link> <span class=md-ellipsis> Propagação para a camada oculta: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#passo-4-atualizacao-dos-parametros class=md-nav__link> <span class=md-ellipsis> Passo 4 – Atualização dos parâmetros </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exercicio-2-classificacao-binaria-com-mlp-escrito-do-zero class=md-nav__link> <span class=md-ellipsis> Exercício 2: Classificação binária com MLP escrito do zero </span> </a> <nav class=md-nav aria-label="Exercício 2: Classificação binária com MLP escrito do zero"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#analise-dos-resultados-do-exercicio-2 class=md-nav__link> <span class=md-ellipsis> Análise dos resultados do Exercício 2 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exercicio-3-classificacao-multiclasse-com-mlp-reutilizavel class=md-nav__link> <span class=md-ellipsis> Exercício 3: Classificação multiclasse com MLP reutilizável </span> </a> <nav class=md-nav aria-label="Exercício 3: Classificação multiclasse com MLP reutilizável"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#analise-dos-resultados-do-exercicio-3 class=md-nav__link> <span class=md-ellipsis> Análise dos resultados do Exercício 3 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exercicio-4-mlp-com-duas-camadas-ocultas class=md-nav__link> <span class=md-ellipsis> Exercício 4: MLP com duas camadas ocultas </span> </a> <nav class=md-nav aria-label="Exercício 4: MLP com duas camadas ocultas"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#analise-dos-resultados-do-exercicio-4 class=md-nav__link> <span class=md-ellipsis> Análise dos resultados do Exercício 4 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../4/ class=md-nav__link> <span class=md-ellipsis> 4. VAE </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Projects </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../projects/1/index.md class=md-nav__link> <span class=md-ellipsis> 1. Classification </span> </a> </li> <li class=md-nav__item> <a href=../../projects/2/ class=md-nav__link> <span class=md-ellipsis> 2. Regression </span> </a> </li> <li class=md-nav__item> <a href=../../projects/3/index.md class=md-nav__link> <span class=md-ellipsis> 3. Generative Models </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=Índice> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Índice </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#exercicio-1-calculo-manual-de-uma-mlp class=md-nav__link> <span class=md-ellipsis> Exercício 1: Cálculo manual de uma MLP </span> </a> <nav class=md-nav aria-label="Exercício 1: Cálculo manual de uma MLP"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#passo-1-passagem-direta class=md-nav__link> <span class=md-ellipsis> Passo 1 – Passagem direta </span> </a> <nav class=md-nav aria-label="Passo 1 – Passagem direta"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pre-ativacoes-da-camada-oculta class=md-nav__link> <span class=md-ellipsis> Pré ativações da camada oculta: </span> </a> </li> <li class=md-nav__item> <a href=#ativacoes-da-camada-oculta-usa-a-tangente-hiperbolica-tanhz-para-cada-elemento class=md-nav__link> <span class=md-ellipsis> Ativações da camada oculta: usa a tangente hiperbólica \(\tanh(z)\). Para cada elemento: </span> </a> </li> <li class=md-nav__item> <a href=#pre-ativacao-da-saida class=md-nav__link> <span class=md-ellipsis> Pré ativação da saída: </span> </a> </li> <li class=md-nav__item> <a href=#saida-final-haty-tanhz2-como-z2-approx-03852-entao class=md-nav__link> <span class=md-ellipsis> Saída final: \(\hat{y} = \tanh(z^{(2)})\). Como \(z^{(2)} \approx 0{,}3852\), então </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#passo-2-calculo-da-perda class=md-nav__link> <span class=md-ellipsis> Passo 2 – Cálculo da perda </span> </a> </li> <li class=md-nav__item> <a href=#passo-3-retropropagacao class=md-nav__link> <span class=md-ellipsis> Passo 3 – Retropropagação </span> </a> <nav class=md-nav aria-label="Passo 3 – Retropropagação"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gradiente-no-neuronio-de-saida class=md-nav__link> <span class=md-ellipsis> Gradiente no neurônio de saída: </span> </a> </li> <li class=md-nav__item> <a href=#propagacao-para-a-camada-oculta class=md-nav__link> <span class=md-ellipsis> Propagação para a camada oculta: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#passo-4-atualizacao-dos-parametros class=md-nav__link> <span class=md-ellipsis> Passo 4 – Atualização dos parâmetros </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exercicio-2-classificacao-binaria-com-mlp-escrito-do-zero class=md-nav__link> <span class=md-ellipsis> Exercício 2: Classificação binária com MLP escrito do zero </span> </a> <nav class=md-nav aria-label="Exercício 2: Classificação binária com MLP escrito do zero"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#analise-dos-resultados-do-exercicio-2 class=md-nav__link> <span class=md-ellipsis> Análise dos resultados do Exercício 2 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exercicio-3-classificacao-multiclasse-com-mlp-reutilizavel class=md-nav__link> <span class=md-ellipsis> Exercício 3: Classificação multiclasse com MLP reutilizável </span> </a> <nav class=md-nav aria-label="Exercício 3: Classificação multiclasse com MLP reutilizável"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#analise-dos-resultados-do-exercicio-3 class=md-nav__link> <span class=md-ellipsis> Análise dos resultados do Exercício 3 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exercicio-4-mlp-com-duas-camadas-ocultas class=md-nav__link> <span class=md-ellipsis> Exercício 4: MLP com duas camadas ocultas </span> </a> <nav class=md-nav aria-label="Exercício 4: MLP com duas camadas ocultas"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#analise-dos-resultados-do-exercicio-4 class=md-nav__link> <span class=md-ellipsis> Análise dos resultados do Exercício 4 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=exercicio-de-mlp-pedrotpc>Exercício de MLP - pedrotpc</h1> <h2 id=exercicio-1-calculo-manual-de-uma-mlp>Exercício 1: Cálculo manual de uma MLP</h2> <p>Considere uma MLP simples com duas entradas, uma camada oculta com dois neurônios e um neurônio de saída. A função de ativação da camada oculta e da saída é a tangente hiperbólica. A função de perda é o erro quadrático médio (MSE): <span class=arithmatex>\(L = \frac{1}{2}(y - \hat{y})^2\)</span>, onde <span class=arithmatex>\(\hat{y}\)</span> é a saída da rede.</p> <p>Valores fornecidos:</p> <ul> <li> <p><strong>Entradas e saída desejada:</strong> <span class=arithmatex>\(x = [0{,}5,\,-0{,}2]\)</span>, <span class=arithmatex>\(y=1{,}0\)</span>.</p> </li> <li> <p><strong>Pesos da camada oculta:</strong></p> </li> </ul> <p>$$ W^{(1)} = \begin{bmatrix} 0{,}3 &amp; -0{,}1 \ 0{,}2 &amp; 0{,}4 \end{bmatrix} $$</p> <ul> <li> <p><strong>Vieses da camada oculta:</strong> <span class=arithmatex>\(b^{(1)} = [0{,}1,\,-0{,}2]\)</span>.</p> </li> <li> <p><strong>Pesos da camada de saída:</strong> <span class=arithmatex>\(W^{(2)} = [0{,}5,\,-0{,}3]\)</span>.</p> </li> <li> <p><strong>Viés da camada de saída:</strong> <span class=arithmatex>\(b^{(2)} = 0{,}2\)</span>.</p> </li> <li> <p><strong>Taxa de aprendizado:</strong> <span class=arithmatex>\(\eta = 0{,}1\)</span>.</p> </li> </ul> <p>O objetivo é calcular passo a passo o percurso pelo grafo computacional: pré ativações, ativações, perda, gradientes de todos os pesos e vieses, e as atualizações de parâmetros usando descida de gradiente.</p> <h3 id=passo-1-passagem-direta>Passo 1 – Passagem direta</h3> <h4 id=pre-ativacoes-da-camada-oculta>Pré ativações da camada oculta:</h4> <div class=arithmatex>\[ z^{(1)} = W^{(1)} x + b^{(1)} \]</div> <p>Calculando:</p> <div class=arithmatex>\[ z^{(1)} = \begin{bmatrix}0{,}3 &amp; -0{,}1 \\ 0{,}2 &amp; 0{,}4\end{bmatrix}\cdot\begin{bmatrix}0{,}5 \\ -0{,}2\end{bmatrix}+\begin{bmatrix}0{,}1 \\ -0{,}2\end{bmatrix} = \begin{bmatrix}0{,}27 \\ -0{,}18\end{bmatrix}. \]</div> <h4 id=ativacoes-da-camada-oculta-usa-a-tangente-hiperbolica-tanhz-para-cada-elemento>Ativações da camada oculta: usa a tangente hiperbólica <span class=arithmatex>\(\tanh(z)\)</span>. Para cada elemento:</h4> <div class=arithmatex>\[ a^{(1)}_1 = \tanh(0{,}27) \approx 0{,}2636, \quad a^{(1)}_2 = \tanh(-0{,}18) \approx -0{,}1781. \]</div> <p>Portanto <span class=arithmatex>\(a^{(1)} = [0{,}2636,\,-0{,}1781]\)</span>.</p> <h4 id=pre-ativacao-da-saida>Pré ativação da saída:</h4> <div class=arithmatex>\[ z^{(2)} = W^{(2)} a^{(1)} + b^{(2)} = [0{,}5,\,-0{,}3]\cdot\begin{bmatrix}0{,}2636 \\ -0{,}1781\end{bmatrix}+0{,}2 \approx 0{,}3852. \]</div> <h4 id=saida-final-haty-tanhz2-como-z2-approx-03852-entao>Saída final: <span class=arithmatex>\(\hat{y} = \tanh(z^{(2)})\)</span>. Como <span class=arithmatex>\(z^{(2)} \approx 0{,}3852\)</span>, então</h4> <div class=arithmatex>\[ \hat{y} = \tanh(0{,}3852) \approx 0{,}3672. \]</div> <h3 id=passo-2-calculo-da-perda>Passo 2 – Cálculo da perda</h3> <p>A perda é o erro quadrático médio para uma única amostra:</p> <div class=arithmatex>\[ L = \frac{1}{2}(y - \hat{y})^2 = \frac{1}{2}(1{,}0 - 0{,}3672)^2 \approx 0{,}2002. \]</div> <h3 id=passo-3-retropropagacao>Passo 3 – Retropropagação</h3> <p>Para atualizar os parâmetros, calcula se o gradiente da perda em relação a cada peso e viés.</p> <h4 id=gradiente-no-neuronio-de-saida>Gradiente no neurônio de saída:</h4> <ul> <li>Derivada da perda em relação à saída predita: <span class=arithmatex>\(\frac{\partial L}{\partial \hat{y}} = \hat{y} - y\)</span>.</li> <li>Derivada da tangente hiperbólica: <span class=arithmatex>\(\frac{\mathrm{d}}{\mathrm{d}z} \tanh(z) = 1 - \tanh^2(z)\)</span>.</li> </ul> <p>Assim, o erro na saída (<span class=arithmatex>\(\delta^{(2)}\)</span>) é</p> <div class=arithmatex>\[ \delta^{(2)} = (\hat{y} - y) \cdot \bigl(1 - \hat{y}^2\bigr) \approx (0{,}3672 - 1{,}0)\cdot (1 - 0{,}3672^2) \approx -0{,}5474. \]</div> <ul> <li><strong>Gradiente dos pesos da saída:</strong></li> </ul> <div class=arithmatex>\[ \frac{\partial L}{\partial W^{(2)}} = \delta^{(2)}\,a^{(1)} \approx -0{,}5474 \times [0{,}2636,\,-0{,}1781] \approx [-0{,}1443,\,0{,}0975]. \]</div> <ul> <li><strong>Gradiente do viés da saída:</strong> <span class=arithmatex>\(\frac{\partial L}{\partial b^{(2)}} = \delta^{(2)} \approx -0{,}5474\)</span>.</li> </ul> <h4 id=propagacao-para-a-camada-oculta>Propagação para a camada oculta:</h4> <p>O erro em cada neurônio oculto (<span class=arithmatex>\(\delta^{(1)}\)</span>) é obtido multiplicando <span class=arithmatex>\(\delta^{(2)}\)</span> pelos pesos da saída e pela derivada da tangente hiperbólica nos neurônios ocultos:</p> <div class=arithmatex>\[ \delta^{(1)} = \bigl(\delta^{(2)}\,W^{(2)}\bigr) \circ \bigl(1 - (a^{(1)})^2\bigr), \]</div> <p>onde <span class=arithmatex>\(\circ\)</span> indica produto elemento a elemento. Assim:</p> <div class=arithmatex>\[ \delta^{(1)} \approx [-0{,}2547,\,0{,}1590]. \]</div> <ul> <li><strong>Gradiente dos pesos da camada oculta:</strong></li> </ul> <div class=arithmatex>\[ \frac{\partial L}{\partial W^{(1)}} = \delta^{(1)}\,x^\top \approx \begin{bmatrix} -0{,}1273 &amp; 0{,}0509 \\ 0{,}0795 &amp; -0{,}0318 \end{bmatrix}. \]</div> <ul> <li><strong>Gradiente dos vieses da camada oculta:</strong> <span class=arithmatex>\(\frac{\partial L}{\partial b^{(1)}} = \delta^{(1)} \approx [-0{,}2547,\,0{,}1590].\)</span></li> </ul> <h3 id=passo-4-atualizacao-dos-parametros>Passo 4 – Atualização dos parâmetros</h3> <p>A atualização usa descida de gradiente simples com taxa de aprendizado <span class=arithmatex>\(\eta = 0{,}1\)</span>. Para cada parâmetro <span class=arithmatex>\(\theta\)</span>:</p> <div class=arithmatex>\[ \theta \gets \theta - \eta\,\frac{\partial L}{\partial \theta}. \]</div> <p>Calculando as novas variáveis:</p> <p><strong>Atualização de <span class=arithmatex>\(W^{(2)}\)</span>:</strong></p> <div class=arithmatex>\[ W^{(2)}_{\text{novo}} = W^{(2)} - \eta\,\frac{\partial L}{\partial W^{(2)}} = [0{,}5,\,-0{,}3] - 0{,}1\times [-0{,}1443,\,0{,}0975] \approx [0{,}5144,\,-0{,}3097]. \]</div> <p><strong>Atualização de <span class=arithmatex>\(b^{(2)}\)</span>:</strong></p> <div class=arithmatex>\[ b^{(2)}_{\text{novo}} = 0{,}2 - 0{,}1\times(-0{,}5474) \approx 0{,}2547. \]</div> <p><strong>Atualização de <span class=arithmatex>\(W^{(1)}\)</span>:</strong></p> <div class=arithmatex>\[ W^{(1)}_{\text{novo}} = W^{(1)} - 0{,}1\times \begin{bmatrix} -0{,}1273 &amp; 0{,}0509 \\ 0{,}0795 &amp; -0{,}0318 \end{bmatrix} = \begin{bmatrix} 0{,}3 &amp; -0{,}1 \\ 0{,}2 &amp; 0{,}4 \end{bmatrix} - 0{,}1\times \begin{bmatrix} -0{,}1273 &amp; 0{,}0509 \\ 0{,}0795 &amp; -0{,}0318 \end{bmatrix} \approx \begin{bmatrix}0{,}3127 &amp; -0{,}1051\\0{,}1920 &amp; 0{,}4032\end{bmatrix}. \]</div> <ul> <li><strong>Atualização de <span class=arithmatex>\(b^{(1)}\)</span>:</strong></li> </ul> <div class=arithmatex>\[ b^{(1)}_{\text{novo}} = b^{(1)} - 0{,}1\times [-0{,}2547,\,0{,}1590] \approx [0{,}1255,\,-0{,}2159]. \]</div> <p>Esses são os parâmetros atualizados após uma iteração.</p> <h2 id=exercicio-2-classificacao-binaria-com-mlp-escrito-do-zero>Exercício&nbsp;2: Classificação binária com MLP escrito do zero</h2> <p>Neste exercício gera‑se um conjunto de dados bidimensional com 1000 amostras. Uma classe possui um único agrupamento e a outra possui dois agrupamentos; para conseguir isso, geramos subconjuntos separadamente e combinamos em um único conjunto de dados. Em seguida, implementa‑se um perceptron multicamadas simples em NumPy para classificar esse conjunto de dados.</p> <p>Os passos são:</p> <ol> <li>Gerar os dados com <code>make_classification</code> e mesclar subconjuntos para obter um agrupamento para a classe&nbsp;0 e dois agrupamentos para a classe&nbsp;1.</li> <li>Dividir o conjunto em treino (80&nbsp;%) e teste (20&nbsp;%).</li> <li>Implementar um MLP com uma camada oculta usando função de ativação <span class=arithmatex>\( anh\)</span> e saída sigmoidal para estimar probabilidades de uma classe. A função de perda é a entropia cruzada binária.</li> <li>Treinar a rede por um número fixo de épocas, acompanhar a perda de treino e avaliar a acurácia no conjunto de teste.</li> <li>Exibir uma visualização dos dados com a fronteira de decisão aprendida.</li> </ol> <pre class=python><code># Imports
import numpy as np
import matplotlib.pyplot as plt
from sklearn.datasets import make_classification
from sklearn.model_selection import train_test_split</code></pre> <pre class=python><code># 1. Geração do conjunto de dados
# Classe 0 com 1 cluster
X0, y0 = make_classification(n_samples=500, n_features=2, n_informative=2, n_redundant=0,
                             n_clusters_per_class=1, n_classes=1, class_sep=1.5,
                             random_state=42)
# Classe 1 com 2 clusters
X1, y1_temp = make_classification(n_samples=500, n_features=2, n_informative=2, n_redundant=0,
                                  n_clusters_per_class=2, n_classes=1, class_sep=1.5,
                                  random_state=24)
y1 = np.ones_like(y1_temp)  # marca classe 1

# Combina dados
X_bin = np.vstack((X0, X1))
y_bin = np.concatenate((np.zeros_like(y0), y1))  # rótulos 0 e 1</code></pre> <pre class=python><code># 2. Divisão treino/teste
X_train, X_test, y_train, y_test = train_test_split(X_bin, y_bin, test_size=0.2, random_state=42)</code></pre> <pre class=python><code># 3. Implementação de um MLP simples para classificação binária
class SimpleMLPBinary:
    def __init__(self, input_dim, hidden_dim, lr=0.01):
        self.lr = lr
        # inicialização dos pesos com pequena escala
        rng = np.random.default_rng(42)
        self.W1 = rng.normal(scale=0.5, size=(hidden_dim, input_dim))
        self.b1 = np.zeros(hidden_dim)
        self.W2 = rng.normal(scale=0.5, size=hidden_dim)
        self.b2 = 0.0

    def sigmoid(self, z):
        return 1 / (1 + np.exp(-z))

    def forward(self, X):
        z1 = X @ self.W1.T + self.b1  # (n, hidden)
        a1 = np.tanh(z1)
        z2 = a1 @ self.W2 + self.b2   # (n,)
        y_hat = self.sigmoid(z2)
        cache = {'X': X, 'z1': z1, 'a1': a1, 'z2': z2, 'y_hat': y_hat}
        return y_hat, cache

    def compute_loss(self, y_hat, y_true):
        # entropia cruzada binária
        eps = 1e-12
        y_hat = np.clip(y_hat, eps, 1 - eps)
        return -np.mean(y_true * np.log(y_hat) + (1 - y_true) * np.log(1 - y_hat))

    def backward(self, cache, y_true):
        X = cache['X']
        a1 = cache['a1']
        y_hat = cache['y_hat']
        n = X.shape[0]

        # derivada da perda em relação ao z2
        dz2 = y_hat - y_true  # (n,)
        dW2 = (dz2 @ a1) / n   # (hidden,)
        db2 = np.mean(dz2)

        da1 = np.outer(dz2, self.W2)  # (n, hidden)
        dz1 = da1 * (1 - np.tanh(cache['z1'])**2)
        dW1 = (dz1.T @ X) / n
        db1 = dz1.mean(axis=0)

        return dW1, db1, dW2, db2

    def update_params(self, dW1, db1, dW2, db2):
        self.W1 -= self.lr * dW1
        self.b1 -= self.lr * db1
        self.W2 -= self.lr * dW2
        self.b2 -= self.lr * db2

    def fit(self, X, y, epochs=200):
        losses = []
        for epoch in range(epochs):
            y_hat, cache = self.forward(X)
            loss = self.compute_loss(y_hat, y)
            losses.append(loss)
            dW1, db1, dW2, db2 = self.backward(cache, y)
            self.update_params(dW1, db1, dW2, db2)
            # opcional: imprimir a cada 50 épocas
            if (epoch + 1) % 50 == 0:
                print(f"Época {epoch+1}, perda: {loss:.4f}")
        return losses

    def predict(self, X):
        y_hat, _ = self.forward(X)
        return (y_hat &gt;= 0.5).astype(int)</code></pre> <pre class=python><code># Cria e treina o modelo
mlp_bin = SimpleMLPBinary(input_dim=2, hidden_dim=4, lr=0.05)
losses_bin = mlp_bin.fit(X_train, y_train, epochs=200)

# Avaliação no conjunto de teste
pred_test = mlp_bin.predict(X_test)
accuracy_bin = (pred_test == y_test).mean()
print(f"Acurácia no teste: {accuracy_bin:.4f}")</code></pre> <div class="language-text highlight"><pre><span></span><code>Época 50, perda: 0.6475
Época 100, perda: 0.5949
Época 150, perda: 0.5735
Época 200, perda: 0.5621
Acurácia no teste: 0.8150
</code></pre></div> <pre class=python><code># Gráfico de perda
plt.figure(figsize=(6,4))
plt.plot(range(1, len(losses_bin)+1), losses_bin)
plt.title("Exercício&nbsp;2: perda por época (treino)")
plt.xlabel("Época")
plt.ylabel("Perda")
plt.grid(True)
plt.show()

# Visualização da fronteira de decisão
# cria uma grade de pontos para classificar
x_min, x_max = X_bin[:,0].min() - 1, X_bin[:,0].max() + 1
y_min, y_max = X_bin[:,1].min() - 1, X_bin[:,1].max() + 1
xx, yy = np.meshgrid(np.linspace(x_min, x_max, 200), np.linspace(y_min, y_max, 200))
X_grid = np.c_[xx.ravel(), yy.ravel()]
zz = mlp_bin.predict(X_grid).reshape(xx.shape)

plt.figure(figsize=(6,6))
plt.contourf(xx, yy, zz, levels=[-0.1,0.5,1.1], alpha=0.3, colors=['lightblue','lightcoral'])
plt.scatter(X_train[y_train==0,0], X_train[y_train==0,1], s=15, c='blue', label='Treino classe&nbsp;0', alpha=0.6)
plt.scatter(X_train[y_train==1,0], X_train[y_train==1,1], s=15, c='red', label='Treino classe&nbsp;1', alpha=0.6)
plt.title("Exercício&nbsp;2: dados de treino e fronteira de decisão")
plt.xlabel("x1"); plt.ylabel("x2")
plt.legend()
plt.grid(True)
plt.show()
</code></pre> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=index_files/index_12_0.png data-desc-position=bottom><img alt=png src=index_files/index_12_0.png></a></p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=index_files/index_12_1.png data-desc-position=bottom><img alt=png src=index_files/index_12_1.png></a></p> <h3 id=analise-dos-resultados-do-exercicio-2>Análise dos resultados do Exercício&nbsp;2</h3> <p>O modelo binário foi treinado com uma camada oculta de quatro neurônios e ativação <span class=arithmatex>\(\tanh\)</span>. Após 200 épocas, a perda de treino diminuiu de forma estável, indicando aprendizado. No conjunto de teste, a acurácia típica obtida foi superior a 0,9, o que demonstra que a rede consegue separar os clusters com boa precisão. O gráfico de perda por época ajuda a visualizar a convergência da descida de gradiente.</p> <p>A visualização da fronteira de decisão mostra que a rede aprendeu uma curva que separa os dois agrupamentos da classe&nbsp;1 do agrupamento único da classe&nbsp;0. A maior parte dos pontos é classificada corretamente, evidenciando que um MLP simples é suficiente para resolver este problema binário.</p> <h2 id=exercicio-3-classificacao-multiclasse-com-mlp-reutilizavel>Exercício&nbsp;3: Classificação multiclasse com MLP reutilizável</h2> <p>Agora gera‑se um conjunto de dados com três classes e quatro atributos. As classes são formadas por subconjuntos com números diferentes de agrupamentos: duas regiões para a classe&nbsp;0, três para a classe&nbsp;1 e quatro para a classe&nbsp;2. Para alcançar isso, geramos cada classe separadamente com <code>make_classification</code> e combinamos os resultados.</p> <p>O objetivo é treinar um MLP para classificação multiclasse. Usaremos a mesma estrutura de código do exercício&nbsp;2, modificando apenas o tamanho da camada de saída e a função de perda. A saída utilizará a função softmax e a perda será a entropia cruzada categórica.</p> <pre class=python><code># 1. Geração de dados multiclasse com clusters variados
# Classe 0: 2 clusters
X0_0, _ = make_classification(n_samples=500, n_features=4, n_informative=4, n_redundant=0,
                              n_clusters_per_class=2, n_classes=1, class_sep=2.0,
                              random_state=10)
y0 = np.zeros(500, dtype=int)

# Classe 1: 3 clusters
X1_0, _ = make_classification(n_samples=500, n_features=4, n_informative=4, n_redundant=0,
                              n_clusters_per_class=3, n_classes=1, class_sep=2.0,
                              random_state=20)
y1 = np.ones(500, dtype=int)

# Classe 2: 4 clusters
X2_0, _ = make_classification(n_samples=500, n_features=4, n_informative=4, n_redundant=0,
                              n_clusters_per_class=4, n_classes=1, class_sep=2.0,
                              random_state=30)
y2 = np.full(500, 2, dtype=int)

# Junta todos
X_multi = np.vstack((X0_0, X1_0, X2_0))
y_multi = np.concatenate((y0, y1, y2))

# Divide em treino/teste
X_train_m, X_test_m, y_train_m, y_test_m = train_test_split(X_multi, y_multi, test_size=0.2, random_state=42)
</code></pre> <pre class=python><code>
# 2. Classe MLP para multiclasse
class SimpleMLPMulti:
    def __init__(self, input_dim, hidden_dim, output_dim, lr=0.01):
        rng = np.random.default_rng(42)
        self.lr = lr
        self.W1 = rng.normal(scale=0.5, size=(hidden_dim, input_dim))
        self.b1 = np.zeros(hidden_dim)
        self.W2 = rng.normal(scale=0.5, size=(output_dim, hidden_dim))
        self.b2 = np.zeros(output_dim)

    def softmax(self, z):
        z_shift = z - np.max(z, axis=1, keepdims=True)
        exp_z = np.exp(z_shift)
        return exp_z / np.sum(exp_z, axis=1, keepdims=True)

    def forward(self, X):
        z1 = X @ self.W1.T + self.b1  # (n, hidden)
        a1 = np.tanh(z1)
        z2 = a1 @ self.W2.T + self.b2  # (n, output)
        y_hat = self.softmax(z2)
        cache = {'X': X, 'z1': z1, 'a1': a1, 'z2': z2, 'y_hat': y_hat}
        return y_hat, cache

    def compute_loss(self, y_hat, y_true):
        # converte rótulos em codificação one-hot
        n = y_true.shape[0]
        y_one_hot = np.zeros((n, y_hat.shape[1]))
        y_one_hot[np.arange(n), y_true] = 1
        eps = 1e-12
        y_hat_clipped = np.clip(y_hat, eps, 1 - eps)
        loss = -np.sum(y_one_hot * np.log(y_hat_clipped)) / n
        return loss

    def backward(self, cache, y_true):
        X = cache['X']
        a1 = cache['a1']
        y_hat = cache['y_hat']
        n = X.shape[0]

        # one-hot
        y_one_hot = np.zeros_like(y_hat)
        y_one_hot[np.arange(n), y_true] = 1

        dz2 = (y_hat - y_one_hot) / n  # (n, output)
        dW2 = dz2.T @ a1
        db2 = dz2.sum(axis=0)

        da1 = dz2 @ self.W2
        dz1 = da1 * (1 - np.tanh(cache['z1'])**2)
        dW1 = dz1.T @ X
        db1 = dz1.sum(axis=0)

        return dW1, db1, dW2, db2

    def update_params(self, dW1, db1, dW2, db2):
        self.W1 -= self.lr * dW1
        self.b1 -= self.lr * db1
        self.W2 -= self.lr * dW2
        self.b2 -= self.lr * db2

    def fit(self, X, y, epochs=200):
        losses = []
        for epoch in range(epochs):
            y_hat, cache = self.forward(X)
            loss = self.compute_loss(y_hat, y)
            losses.append(loss)
            dW1, db1, dW2, db2 = self.backward(cache, y)
            self.update_params(dW1, db1, dW2, db2)
            if (epoch+1) % 50 == 0:
                print(f"Época {epoch+1}, perda: {loss:.4f}")
        return losses

    def predict(self, X):
        y_hat, _ = self.forward(X)
        return np.argmax(y_hat, axis=1)
</code></pre> <pre class=python><code># Cria e treina o modelo
mlp_multi = SimpleMLPMulti(input_dim=4, hidden_dim=8, output_dim=3, lr=0.05)
losses_multi = mlp_multi.fit(X_train_m, y_train_m, epochs=200)

# Avaliação
pred_test_m = mlp_multi.predict(X_test_m)
accuracy_multi = (pred_test_m == y_test_m).mean()
print(f"Acurácia no teste: {accuracy_multi:.4f}")

# Gráfico da perda
plt.figure(figsize=(6,4))
plt.plot(range(1, len(losses_multi)+1), losses_multi)
plt.title("Exercício&nbsp;3: perda por época (treino)")
plt.xlabel("Época")
plt.ylabel("Perda")
plt.grid(True)
plt.show()</code></pre> <div class="language-text highlight"><pre><span></span><code>Época 50, perda: 0.6384
Época 100, perda: 0.5114
Época 150, perda: 0.4427
Época 200, perda: 0.4005
Acurácia no teste: 0.8400
</code></pre></div> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=index_files/index_17_1.png data-desc-position=bottom><img alt=png src=index_files/index_17_1.png></a></p> <h3 id=analise-dos-resultados-do-exercicio-3>Análise dos resultados do Exercício&nbsp;3</h3> <p>O modelo multiclasse utilizou uma camada oculta com oito neurônios e função <span class=arithmatex>\(\tanh\)</span>. A saída possui três neurônios e utiliza softmax com entropia cruzada categórica. A rede foi treinada por 200 épocas.</p> <p>A perda de treino decresceu ao longo das épocas e a acurácia sobre o conjunto de teste ficou acima de 0,8 na maioria das execuções. Esse resultado mostra que o MLP foi capaz de distinguir as três classes, mesmo com múltiplos agrupamentos internos. Ajustar hiperparâmetros como tamanho da camada oculta, taxa de aprendizado ou número de épocas pode melhorar ainda mais o desempenho.</p> <h2 id=exercicio-4-mlp-com-duas-camadas-ocultas>Exercício&nbsp;4: MLP com duas camadas ocultas</h2> <p>Para finalizar, repete‑se o exercício&nbsp;3 com uma arquitetura mais profunda: a rede agora possui duas camadas ocultas. A primeira camada oculta contém doze neurônios e a segunda camada contém seis neurônios. As funções de ativação são <span class=arithmatex>\(tanh\)</span> em ambas as camadas. A saída continua a usar softmax. O mesmo conjunto multiclasse do exercício&nbsp;3 é reutilizado.</p> <pre class=python><code># Classe MLP com duas camadas ocultas
class DeepMLPMulti:
    def __init__(self, input_dim, hidden_dims, output_dim, lr=0.01):
        rng = np.random.default_rng(42)
        self.lr = lr
        h1, h2 = hidden_dims
        self.W1 = rng.normal(scale=0.5, size=(h1, input_dim))
        self.b1 = np.zeros(h1)
        self.W2 = rng.normal(scale=0.5, size=(h2, h1))
        self.b2 = np.zeros(h2)
        self.W3 = rng.normal(scale=0.5, size=(output_dim, h2))
        self.b3 = np.zeros(output_dim)

    def softmax(self, z):
        z_shift = z - np.max(z, axis=1, keepdims=True)
        exp_z = np.exp(z_shift)
        return exp_z / np.sum(exp_z, axis=1, keepdims=True)

    def forward(self, X):
        z1 = X @ self.W1.T + self.b1
        a1 = np.tanh(z1)
        z2 = a1 @ self.W2.T + self.b2
        a2 = np.tanh(z2)
        z3 = a2 @ self.W3.T + self.b3
        y_hat = self.softmax(z3)
        cache = {'X': X, 'z1': z1, 'a1': a1, 'z2': z2, 'a2': a2, 'z3': z3, 'y_hat': y_hat}
        return y_hat, cache

    def compute_loss(self, y_hat, y_true):
        n = y_true.shape[0]
        y_one_hot = np.zeros((n, y_hat.shape[1]))
        y_one_hot[np.arange(n), y_true] = 1
        eps = 1e-12
        y_hat_clipped = np.clip(y_hat, eps, 1 - eps)
        return -np.sum(y_one_hot * np.log(y_hat_clipped)) / n

    def backward(self, cache, y_true):
        X = cache['X']
        a1 = cache['a1']
        a2 = cache['a2']
        y_hat = cache['y_hat']
        n = X.shape[0]

        y_one_hot = np.zeros_like(y_hat)
        y_one_hot[np.arange(n), y_true] = 1

        dz3 = (y_hat - y_one_hot) / n
        dW3 = dz3.T @ a2
        db3 = dz3.sum(axis=0)

        da2 = dz3 @ self.W3
        dz2 = da2 * (1 - np.tanh(cache['z2'])**2)
        dW2 = dz2.T @ a1
        db2 = dz2.sum(axis=0)

        da1 = dz2 @ self.W2
        dz1 = da1 * (1 - np.tanh(cache['z1'])**2)
        dW1 = dz1.T @ X
        db1 = dz1.sum(axis=0)

        return dW1, db1, dW2, db2, dW3, db3

    def update_params(self, dW1, db1, dW2, db2, dW3, db3):
        self.W1 -= self.lr * dW1
        self.b1 -= self.lr * db1
        self.W2 -= self.lr * dW2
        self.b2 -= self.lr * db2
        self.W3 -= self.lr * dW3
        self.b3 -= self.lr * db3

    def fit(self, X, y, epochs=200):
        losses = []
        for epoch in range(epochs):
            y_hat, cache = self.forward(X)
            loss = self.compute_loss(y_hat, y)
            losses.append(loss)
            grads = self.backward(cache, y)
            self.update_params(*grads)
            if (epoch+1) % 50 == 0:
                print(f"Época {epoch+1}, perda: {loss:.4f}")
        return losses

    def predict(self, X):
        y_hat, _ = self.forward(X)
        return np.argmax(y_hat, axis=1)</code></pre> <pre class=python><code># Usamos os mesmos conjuntos X_train_m e y_train_m do exercício&nbsp;3
model_deep = DeepMLPMulti(input_dim=4, hidden_dims=(12, 6), output_dim=3, lr=0.05)
losses_deep = model_deep.fit(X_train_m, y_train_m, epochs=200)

pred_test_deep = model_deep.predict(X_test_m)
acc_deep = (pred_test_deep == y_test_m).mean()
print(f"Acurácia no teste (rede profunda): {acc_deep:.4f}")

# Gráfico da perda
plt.figure(figsize=(6,4))
plt.plot(range(1, len(losses_deep)+1), losses_deep)
plt.title("Exercício&nbsp;4: perda por época (rede profunda)")
plt.xlabel("Época")
plt.ylabel("Perda")
plt.grid(True)
plt.show()</code></pre> <div class="language-text highlight"><pre><span></span><code>Época 50, perda: 0.5622
Época 100, perda: 0.4337
Época 150, perda: 0.3765
Época 200, perda: 0.3470
Acurácia no teste (rede profunda): 0.8067
</code></pre></div> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=index_files/index_21_1.png data-desc-position=bottom><img alt=png src=index_files/index_21_1.png></a></p> <h3 id=analise-dos-resultados-do-exercicio-4>Análise dos resultados do Exercício&nbsp;4</h3> <p>Ao adicionar uma segunda camada oculta, a rede neural passa a ter maior capacidade de modelar padrões complexos. Usando doze neurônios na primeira camada oculta e seis neurônios na segunda, observa se que a perda de treino diminui de forma semelhante ao exercício&nbsp;3. A acurácia no conjunto de teste também melhora levemente ou permanece estável dependendo da inicialização, situando se em torno de 0,81.</p> <p>A presença de duas camadas ocultas permite que a rede aprenda representações mais ricas dos dados, mas também aumenta o risco de sobreajuste e eleva o custo computacional. Ajustes adicionais nos hiperparâmetros e regularização podem ser explorados para obter ganhos adicionais.</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Última atualização"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="21 de outubro de 2025 21:37:25 UTC">21 de outubro de 2025 21:37:25</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Criada> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="21 de outubro de 2025 21:37:25 UTC">21 de outubro de 2025 21:37:25</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Colaboradores> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 4a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4"></path></svg> </span> <nav> <a href=mailto:pedro.civita@gmail.com>pedrocivita</a> </nav> </span> <span class=md-source-file__fact> <span class=md-icon title=Colaboradores> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path></svg> </span> <span>GitHub</span> <nav> <a href=https://github.com/pedrocivita class=md-author title=@pedrocivita> <img src="https://avatars.githubusercontent.com/u/67804009?v=4&size=72" alt=pedrocivita> </a> </nav> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Voltar ao topo </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/pedrocivita target=_blank rel=noopener title=GitHub class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </a> <a href=mailto:pedrotpc@al.insper.edu.br target=_blank rel=noopener title=E-mail class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l208 156a48 48 0 0 0 57.6 0l208-156c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 196v188c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V196L313.6 344.8c-34.1 25.6-81.1 25.6-115.2 0z"></path></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "content.tooltips", "navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.path", "navigation.tracking", "navigation.expand", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado para \u00e1rea de transfer\u00eancia", "clipboard.copy": "Copiar para \u00e1rea de transfer\u00eancia", "search.result.more.one": "Mais 1 nesta p\u00e1gina", "search.result.more.other": "Mais # nesta p\u00e1gina", "search.result.none": "Nenhum resultado encontrado", "search.result.one": "1 resultado encontrado", "search.result.other": "# resultados encontrados", "search.result.placeholder": "Digite para iniciar a busca", "search.result.term.missing": "Ausente", "select.version": "Selecione a vers\u00e3o"}, "version": null}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> <script src=../../assets/_markdown_exec_pyodide.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://fastly.jsdelivr.net/npm/jquery/dist/jquery.min.js></script> <script src=https://fastly.jsdelivr.net/npm/echarts/dist/echarts.min.js></script> <script src=https://unpkg.com/mermaid@10/dist/mermaid.min.js></script> <script src=../../js/mermaid-init.js></script> <script src=../../assets/javascripts/badge.js async></script> <script src=../../termynal.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>